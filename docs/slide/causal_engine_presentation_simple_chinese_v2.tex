\documentclass[aspectratio=169,12pt]{beamer}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amssymb}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows.meta}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}

% å°è¯•ä½¿ç”¨xeCJKï¼Œå¦‚æœå¤±è´¥åˆ™å¿½ç•¥
\usepackage{xeCJK}
\setCJKmainfont{Arial Unicode MS}

% ä¸»é¢˜è®¾ç½®
\usetheme{Madrid}
\usecolortheme{default}
\usefonttheme{professionalfonts}

% ä»£ç é«˜äº®è®¾ç½®
\lstset{
    language=Python,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue},
    commentstyle=\color{gray},
    stringstyle=\color{orange},
    showstringspaces=false,
    breaklines=true,
    frame=single,
    backgroundcolor=\color{gray!10}
}

% æ ‡é¢˜ä¿¡æ¯
\title{å› æœå¼•æ“â„¢ï¼šè®©æœºå™¨å­¦ä¹ æ›´æ™ºèƒ½}
\subtitle{ä»ç›¸å…³æ€§åˆ°å› æœæ€§çš„é©å‘½}
\author{é¾šé¹¤é˜³}
\date{\today}

\begin{document}

% æ ‡é¢˜é¡µ
\begin{frame}
\titlepage
\end{frame}

% ç›®å½•
\begin{frame}{ä»Šå¤©æˆ‘ä»¬è¦è®²ä»€ä¹ˆï¼Ÿ}
\tableofcontents
\end{frame}

% ç¬¬ä¸€éƒ¨åˆ†ï¼šé—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ
\section{ä¼ ç»Ÿæœºå™¨å­¦ä¹ æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ}

\begin{frame}{ä¼ ç»Ÿæœºå™¨å­¦ä¹ çš„å±€é™æ€§}
\begin{columns}
\column{0.5\textwidth}
\textbf{ä¼ ç»Ÿæœºå™¨å­¦ä¹ åšä»€ä¹ˆï¼Ÿ}
\begin{itemize}
    \item å­¦ä¹ æ•°æ®ä¸­çš„ç›¸å…³æ€§
    \item å°±åƒï¼šçœ‹åˆ°ä¹Œäº‘å°±è¯´è¦ä¸‹é›¨
    \item ä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸‹é›¨
\end{itemize}

\vspace{1em}
\textbf{é—®é¢˜å‡ºç°äº†ï¼š}
\begin{itemize}
    \item æ•°æ®æœ‰å™ªéŸ³å°±ä¸å‡†äº†
    \item æ¯ä¸ªäººçš„å·®å¼‚è¢«å½“ä½œ"å¹²æ‰°"
    \item åªèƒ½å‘Šè¯‰ä½ "æ˜¯ä»€ä¹ˆ"ï¼Œä¸çŸ¥é“"ä¸ºä»€ä¹ˆ"
\end{itemize}

\column{0.5\textwidth}
\begin{center}
\begin{tikzpicture}[scale=0.8]
% ä¼ ç»ŸMLç¤ºæ„å›¾
\node[draw, fill=blue!20, rounded corners, minimum width=2cm, minimum height=1cm] (x) at (0,0) {è¾“å…¥};
\node[draw, fill=black!20, rounded corners, minimum width=2cm, minimum height=1cm] (box) at (3,0) {é»‘ç›’å­};
\node[draw, fill=red!20, rounded corners, minimum width=2cm, minimum height=1cm] (y) at (6,0) {è¾“å‡º};
\draw[->, thick] (x) -- (box);
\draw[->, thick] (box) -- (y);
\node at (3,-1.5) {\small ä¸çŸ¥é“é‡Œé¢å‘ç”Ÿäº†ä»€ä¹ˆ};
\end{tikzpicture}
\end{center}
\end{columns}

\vspace{1em}
\begin{alertblock}{æ ¸å¿ƒé—®é¢˜}
ç°å®ä¸–ç•Œçš„æ•°æ®æ€»æ˜¯æœ‰å™ªéŸ³çš„ï¼Œä¼ ç»Ÿæ–¹æ³•åº”ä»˜ä¸äº†ï¼
\end{alertblock}
\end{frame}

\begin{frame}{æˆ‘ä»¬éœ€è¦ä»€ä¹ˆæ ·çš„è§£å†³æ–¹æ¡ˆï¼Ÿ}
\begin{center}
\begin{tikzpicture}[scale=1.2]
% å¯¹æ¯”å›¾
\node at (0,3) {\textbf{\large ä¼ ç»Ÿæ–¹æ³•}};
\node at (6,3) {\textbf{\large å› æœæ–¹æ³•}};

% ä¼ ç»Ÿæ–¹æ³•
\node[draw, fill=blue!20, rounded corners] (x1) at (-1,1.5) {X};
\node[draw, fill=red!20, rounded corners] (y1) at (1,1.5) {Y};
\draw[->, thick] (x1) -- (y1) node[midway, above] {\small ç›¸å…³æ€§};

% å› æœæ–¹æ³•
\node[draw, fill=blue!20, rounded corners] (x2) at (5,1.5) {X};
\node[draw, circle, fill=yellow!30] (u) at (6,1.5) {U};
\node[draw, fill=red!20, rounded corners] (y2) at (7,1.5) {Y};
\draw[->, thick] (x2) -- (u);
\draw[->, thick] (u) -- (y2);
\node at (6,0.8) {\small ä¸ªä½“ç‰¹å¾};

% ä¼˜åŠ¿å¯¹æ¯”
\node[align=left] at (0,0) {\small â€¢ ç®€å•ç›´æ¥\\â€¢ å®¹æ˜“è¿‡æ‹Ÿåˆ\\â€¢ å™ªéŸ³æ•æ„Ÿ};
\node[align=left] at (6,0) {\small â€¢ ç†è§£æœºåˆ¶\\â€¢ æŠ—å™ªèƒ½åŠ›å¼º\\â€¢ ä¸ªæ€§åŒ–é¢„æµ‹};
\end{tikzpicture}
\end{center}

\begin{block}{å…³é”®æ´å¯Ÿ}
æ¯ä¸ªä¸ªä½“éƒ½æœ‰ç‹¬ç‰¹çš„ç‰¹å¾Uï¼Œè¿™ä¸æ˜¯å™ªéŸ³ï¼Œè€Œæ˜¯æœ‰ç”¨çš„ä¿¡æ¯ï¼
\end{block}
\end{frame}

% ç¬¬äºŒéƒ¨åˆ†ï¼šå› æœå¼•æ“æ€ä¹ˆå·¥ä½œï¼Ÿ
\section{å› æœå¼•æ“â„¢æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ}

\begin{frame}{å› æœå¼•æ“â„¢çš„å››ä¸ªæ­¥éª¤}
\begin{center}
\begin{tikzpicture}[
    scale=1,
    box/.style={draw, rounded corners=5pt, minimum width=1.8cm, minimum height=1cm, font=\small},
    arrow/.style={->, thick, >=Stealth}
]

% ä¸»è¦æµç¨‹
\node[box, fill=blue!20] (X) at (0,0) {è¾“å…¥\\$\mathbf{X}$};
\node[box, fill=green!20] (P) at (2.5,0) {æ„ŸçŸ¥\\Perception};
\node[box, fill=yellow!20] (Ab) at (5,0) {æ¨ç†\\Abduction};
\node[box, fill=orange!20] (Ac) at (7.5,0) {è¡ŒåŠ¨\\Action};
\node[box, fill=red!20] (D) at (10,0) {å†³ç­–\\Decision};

% ç®­å¤´å’Œä¸­é—´å˜é‡
\draw[arrow] (X) -- (P);
\draw[arrow] (P) -- (Ab) node[midway, above, font=\small] {$\mathbf{Z}$};
\draw[arrow] (Ab) -- (Ac) node[midway, above, font=\small] {$\mathbf{U}$};
\draw[arrow] (Ac) -- (D) node[midway, above, font=\small] {$\mathbf{S}$};
\draw[arrow] (D) -- ++(1.5,0) node[right, font=\small] {$\mathbf{Y}$};

% ä¸‹æ–¹è¯´æ˜
\node[align=center, font=\footnotesize] at (2.5,-1.5) {æå–ç‰¹å¾\\åƒäººçœ‹ä¸œè¥¿};
\node[align=center, font=\footnotesize] at (5,-1.5) {æ¨æ–­åŸå› \\æ‰¾åˆ°ä¸ªä½“ç‰¹å¾U};
\node[align=center, font=\footnotesize] at (7.5,-1.5) {è®¡ç®—åˆ†æ•°\\å‡†å¤‡å†³ç­–};
\node[align=center, font=\footnotesize] at (10,-1.5) {æœ€ç»ˆè¾“å‡º\\ç»™å‡ºç­”æ¡ˆ};

\end{tikzpicture}
\end{center}

\vspace{1em}
\begin{alertblock}{æ ¸å¿ƒæ€æƒ³}
å°±åƒåŒ»ç”Ÿçœ‹ç—…ï¼šå…ˆè§‚å¯Ÿç—‡çŠ¶ï¼Œæ¨æ–­ç—…å› ï¼Œå†å¯¹ç—‡ä¸‹è¯ï¼
\end{alertblock}
\end{frame}

% ç¬¬ä¸‰éƒ¨åˆ†ï¼šäº”ç§å·¥ä½œæ¨¡å¼
\section{äº”ç§å·¥ä½œæ¨¡å¼}

\begin{frame}{äº”ç§æ¨ç†æ¨¡å¼}
\begin{center}
\begin{tikzpicture}[scale=0.9]
% ç”»äº”ä¸ªåœ†åœˆä»£è¡¨äº”ç§æ¨¡å¼
\node[circle, draw, fill=gray!20, minimum size=1.5cm] (det) at (0,2) {\small ç¡®å®šæ€§};
\node[circle, draw, fill=blue!20, minimum size=1.5cm] (exo) at (-2,0) {\small ç¯å¢ƒ};
\node[circle, draw, fill=green!20, minimum size=1.5cm] (endo) at (2,0) {\small è®¤çŸ¥};
\node[circle, draw, fill=red!30, minimum size=1.8cm] (std) at (0,-2) {\textbf{æ ‡å‡†}};
\node[circle, draw, fill=yellow!20, minimum size=1.5cm] (samp) at (0,0) {\small é‡‡æ ·};

% è¿çº¿
\draw[dashed] (exo) -- (std);
\draw[dashed] (endo) -- (std);

% è¯´æ˜
\node at (0,3.5) {\textbf{äº”ç§æ¨ç†æ¨¡å¼}};
\node[align=center] at (-4,0) {\small ç¯å¢ƒå™ªéŸ³\\ï¼ˆå¤©æ°”ã€è®¾å¤‡ç­‰ï¼‰};
\node[align=center] at (4,0) {\small è®¤çŸ¥ä¸ç¡®å®š\\ï¼ˆä¸ªä½“å·®å¼‚ï¼‰};
\node[align=center] at (0,-3.5) {\textbf{æ ‡å‡†æ¨¡å¼}\\ç»“åˆä¸¤ç§ä¸ç¡®å®šæ€§};
\end{tikzpicture}
\end{center}

\begin{alertblock}{æ¨èä½¿ç”¨}
\textbf{æ ‡å‡†æ¨¡å¼}åœ¨å¤§å¤šæ•°å®é™…åº”ç”¨ä¸­æ•ˆæœæœ€å¥½ï¼
\end{alertblock}
\end{frame}

% ç¬¬å››éƒ¨åˆ†ï¼šæ€§èƒ½æœ‰å¤šå¥½ï¼Ÿ
\section{å› æœå¼•æ“çš„æ€§èƒ½æœ‰å¤šå¥½ï¼Ÿ}

\begin{frame}{æŠ—å™ªéŸ³èƒ½åŠ›æµ‹è¯•ï¼šå›å½’ä»»åŠ¡}
\begin{columns}
\column{0.5\textwidth}
\begin{center}
\textbf{éšç€å™ªéŸ³å¢åŠ ï¼Œæ€§èƒ½å¦‚ä½•å˜åŒ–ï¼Ÿ}
\begin{tikzpicture}[scale=0.7]
\draw[->] (0,0) -- (5,0) node[right] {å™ªéŸ³æ°´å¹³};
\draw[->] (0,0) -- (0,4) node[above] {è¯¯å·®};

% æ€§èƒ½æ›²çº¿ï¼ˆç®€åŒ–ï¼‰
\draw[red, very thick] (0,0.5) -- (1,1.5) -- (2,2.5) -- (3,3.5) -- (4,3.8);
\draw[blue, very thick] (0,0.5) -- (1,1.2) -- (2,2.2) -- (3,3.2) -- (4,3.5);
\draw[green, ultra thick] (0,0.5) -- (1,0.7) -- (2,0.9) -- (3,1.2) -- (4,1.5);

% å›¾ä¾‹
\node[red] at (4.5,3.6) {\tiny ä¼ ç»Ÿæ–¹æ³•};
\node[blue] at (4.5,3.3) {\tiny PyTorch};
\node[green] at (4.5,1.3) {\tiny å› æœå¼•æ“};

% Xè½´æ ‡ç­¾
\node at (0,-0.3) {\tiny 0\%};
\node at (2,-0.3) {\tiny 30\%};
\node at (4,-0.3) {\tiny 50\%};
\end{tikzpicture}
\end{center}

\column{0.5\textwidth}
\textbf{30\%æ ‡ç­¾å™ªéŸ³ä¸‹çš„è¡¨ç°ï¼š}
\begin{itemize}
    \item ä¼ ç»ŸMLPï¼šè¯¯å·® 47.60
    \item PyTorchï¼šè¯¯å·® 45.32
    \item \textcolor{green}{\textbf{å› æœå¼•æ“ï¼šè¯¯å·® 11.41}}
\end{itemize}

\vspace{1em}
\begin{alertblock}{æƒŠäººæå‡}
\textbf{æ€§èƒ½æå‡76\%ï¼}
\end{alertblock}
\end{columns}

\vspace{1em}
\begin{block}{å…³é”®å‘ç°}
å™ªéŸ³è¶Šå¤šï¼Œå› æœå¼•æ“çš„ä¼˜åŠ¿è¶Šæ˜æ˜¾ï¼
\end{block}
\end{frame}

% ç¬¬äº”éƒ¨åˆ†ï¼šæ€ä¹ˆä½¿ç”¨ï¼Ÿ
\section{æ€ä¹ˆä½¿ç”¨å› æœå¼•æ“ï¼Ÿ}

\begin{frame}[fragile]{å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨}
\begin{block}{å®‰è£…å¾ˆç®€å•}
\begin{lstlisting}
pip install causal-sklearn
\end{lstlisting}
\end{block}

\begin{block}{åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹}
\begin{lstlisting}
from causal_sklearn import MLPCausalRegressor
from sklearn.datasets import make_regression
from sklearn.model_selection import train_test_split

# ç”Ÿæˆæ•°æ®
X, y = make_regression(n_samples=1000, n_features=10, noise=20)
X_train, X_test, y_train, y_test = train_test_split(X, y)

# åˆ›å»ºå’Œè®­ç»ƒæ¨¡å‹
model = MLPCausalRegressor(
    hidden_layer_sizes=(100, 50),
    inference_mode='standard',  # æ¨èä½¿ç”¨æ ‡å‡†æ¨¡å¼
    max_iter=200
)
model.fit(X_train, y_train)

# é¢„æµ‹å’Œè¯„ä¼°
score = model.score(X_test, y_test)
print(f"æµ‹è¯•åˆ†æ•°: {score:.4f}")
\end{lstlisting}
\end{block}
\end{frame}

% ç¬¬å…­éƒ¨åˆ†ï¼šåº”ç”¨åœºæ™¯
\section{é€‚ç”¨åœºæ™¯}

\begin{frame}{ä»€ä¹ˆæ—¶å€™ç”¨å› æœå¼•æ“ï¼Ÿ}
\begin{columns}
\column{0.5\textwidth}
\textbf{ç‰¹åˆ«é€‚åˆçš„åœºæ™¯ï¼š}
\begin{itemize}
    \item $\checkmark$ æ•°æ®æœ‰å¾ˆå¤šå™ªéŸ³çš„æ—¶å€™
    \item $\checkmark$ éœ€è¦ç†è§£ä¸ªä½“å·®å¼‚
    \item $\checkmark$ åŒ»ç–—è¯Šæ–­ï¼ˆä¸ªæ€§åŒ–ï¼‰
    \item $\checkmark$ é‡‘èé£é™©è¯„ä¼°
    \item $\checkmark$ æ¨èç³»ç»Ÿ
    \item $\checkmark$ å¼‚å¸¸æ£€æµ‹
\end{itemize}

\column{0.5\textwidth}
\textbf{ä¼˜åŠ¿ä¸æ˜æ˜¾çš„åœºæ™¯ï¼š}
\begin{itemize}
    \item $\times$ æ•°æ®éå¸¸å¹²å‡€
    \item $\times$ çº¯å›¾åƒåˆ†ç±»
    \item $\times$ ä¸éœ€è¦è§£é‡Šæ€§çš„åœºæ™¯
    \item $\times$ è®¡ç®—èµ„æºæå…¶æœ‰é™
\end{itemize}
\end{columns}

\vspace{1em}
\begin{block}{ç»éªŒæ³•åˆ™}
å½“æ•°æ®è´¨é‡ä¸ç¡®å®šæˆ–éœ€è¦é²æ£’æ€§æ—¶ï¼Œå› æœå¼•æ“æ˜¯ç†æƒ³é€‰æ‹©
\end{block}
\end{frame}

% ç¬¬ä¸ƒéƒ¨åˆ†ï¼šæ€»ç»“
\section{æ€»ç»“ä¸å±•æœ›}

\begin{frame}{æ ¸å¿ƒè´¡çŒ®}
\begin{enumerate}
    \item \textbf{æ–°çš„æœºå™¨å­¦ä¹ èŒƒå¼}
    \begin{itemize}
        \item ä»å­¦ä¹ ç›¸å…³æ€§åˆ°å­¦ä¹ å› æœå…³ç³»
        \item æŠŠä¸ªä½“å·®å¼‚å½“ä½œç‰¹å¾ï¼Œè€Œä¸æ˜¯å™ªéŸ³
    \end{itemize}
    
    \item \textbf{å®ç”¨çš„å®ç°}
    \begin{itemize}
        \item å®Œå…¨å…¼å®¹scikit-learn API
        \item é«˜æ•ˆçš„åˆ†æè®¡ç®—
        \item å®¹æ˜“é›†æˆåˆ°ç°æœ‰å·¥ä½œæµç¨‹
    \end{itemize}
    
    \item \textbf{å‡ºè‰²çš„é²æ£’æ€§}
    \begin{itemize}
        \item åœ¨å™ªéŸ³ç¯å¢ƒä¸­æ€§èƒ½ä¼˜å¼‚
        \item é€‚åˆç°å®ä¸–ç•Œçš„æ··ä¹±æ•°æ®
    \end{itemize}
\end{enumerate}

\vspace{1em}
\begin{block}{ä¸€å¥è¯æ€»ç»“}
å› æœå¼•æ“é€šè¿‡ç†è§£"ä¸ºä»€ä¹ˆ"è€Œä¸ä»…ä»…æ˜¯"æ˜¯ä»€ä¹ˆ"ï¼Œä¸ºæœºå™¨å­¦ä¹ å¸¦æ¥æ–°çš„å¯èƒ½æ€§
\end{block}
\end{frame}

\begin{frame}
\begin{center}
{\Huge \textbf{è°¢è°¢å¤§å®¶ï¼}}

\vspace{2em}

{\Large æœ‰é—®é¢˜å¯ä»¥è®¨è®º}

\vspace{2em}

{\large è®©æœºå™¨å­¦ä¹ å˜å¾—æ›´æ™ºèƒ½ ğŸš€}
\end{center}
\end{frame}

\end{document}